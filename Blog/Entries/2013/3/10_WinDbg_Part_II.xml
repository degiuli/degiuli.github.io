<?xml version="1.0"?>
<content collectionGUID="FB58F55C-9585-4C68-BAD6-2F593DC4614A">
  <lastEdited clientType="local-build-20130324" date="2013-03-24 21:04:14 +0000"/>
  <textBox id="generic-header-attribute" dynamic="no" visible="yes">
    <richText>&lt;a href="perma://BLPageReference/2D085D6A-902D-4579-899A-CF8E11275EFB"&gt;Windows Debugging Series&lt;/a&gt;</richText>
  </textBox>
  <textBox id="generic-title-attributes" dynamic="no" visible="yes">
    <richText>WinDbg Part II</richText>
  </textBox>
  <textBox id="generic-datefield-attributes" dynamic="no" visible="yes">
    <richText>10 de mar&#xE7;o de 2013</richText>
  </textBox>
  <textBox id="generic-body-attributes" dynamic="no" visible="yes">
    <richText>This part continues the WinDbg tool discussed start in &lt;a href="perma://BLPageReference/1B5FFF65-769B-4CD8-9754-AE4691D6C2DC"&gt;Debugging Tools For Windows&lt;/a&gt; post and shows additional commands that helps analyze issue in addition to the !analyze command introduced in &lt;a href="perma://BLPageReference/9AB9878C-254E-484C-9DA7-551431324B22"&gt;WinDbg Part I&lt;/a&gt; post.&#xD;&#xD;The number of command and its parameter are huge and they can be seen through the WinDbg help. This post will introduce few useful commands and some of them options. All options listed here should be executed in the WinDbg window command line. Finally, the list is not particularly grouped.&#xD;&#xD;&lt;i&gt;List of Commands&lt;/i&gt;&#xD;&#xD;~&#xD;This command list all thread, its state, id and environment block address (TEB). The . (as highlighted below) indicates which thread was running when the debug stopped or dump was created.&#xD;0:036&gt; ~&#xD;   0  Id: 109c.1700 Suspend: 0 Teb: 7ffdf000 Unfrozen&#xD;   1  Id: 109c.3ac Suspend: 0 Teb: 7ffdb000 Unfrozen&#xD;   2  Id: 109c.86c Suspend: 0 Teb: 7ffd9000 Unfrozen&#xD;   3  Id: 109c.b90 Suspend: 0 Teb: 7ffd8000 Unfrozen&#xD;   4  Id: 109c.e58 Suspend: 0 Teb: 7ffd6000 Unfrozen&#xD;   5  Id: 109c.156c Suspend: 0 Teb: 7ffd5000 Unfrozen&#xD;   6  Id: 109c.2e4 Suspend: 0 Teb: 7ff4f000 Unfrozen&#xD;   7  Id: 109c.14dc Suspend: 0 Teb: 7ff4e000 Unfrozen&#xD;   8  Id: 109c.1400 Suspend: 0 Teb: 7ff4d000 Unfrozen&#xD;   9  Id: 109c.e50 Suspend: 0 Teb: 7ff4c000 Unfrozen&#xD;  10  Id: 109c.fe4 Suspend: 0 Teb: 7ff4a000 Unfrozen&#xD;  11  Id: 109c.1180 Suspend: 0 Teb: 7ff48000 Unfrozen&#xD;  12  Id: 109c.8a8 Suspend: 0 Teb: 7ff47000 Unfrozen&#xD;  13  Id: 109c.1428 Suspend: 0 Teb: 7ffdd000 Unfrozen&#xD;  14  Id: 109c.be4 Suspend: 0 Teb: 7ff4b000 Unfrozen&#xD;  15  Id: 109c.e30 Suspend: 0 Teb: 7ff42000 Unfrozen&#xD;  16  Id: 109c.11ac Suspend: 0 Teb: 7ff41000 Unfrozen&#xD;  17  Id: 109c.a78 Suspend: 0 Teb: 7ff40000 Unfrozen&#xD;  18  Id: 109c.1354 Suspend: 0 Teb: 7ff3f000 Unfrozen&#xD;  19  Id: 109c.eec Suspend: 0 Teb: 7ff3e000 Unfrozen&#xD;  20  Id: 109c.1454 Suspend: 0 Teb: 7ff3d000 Unfrozen&#xD;  21  Id: 109c.1768 Suspend: 0 Teb: 7ff3c000 Unfrozen&#xD;  22  Id: 109c.1474 Suspend: 0 Teb: 7ff3b000 Unfrozen&#xD;  23  Id: 109c.14ac Suspend: 0 Teb: 7ff3a000 Unfrozen&#xD;  24  Id: 109c.11f8 Suspend: 0 Teb: 7ff39000 Unfrozen&#xD;  25  Id: 109c.8cc Suspend: 0 Teb: 7ff38000 Unfrozen&#xD;  26  Id: 109c.b80 Suspend: 0 Teb: 7ff34000 Unfrozen&#xD;  27  Id: 109c.1188 Suspend: 0 Teb: 7ff33000 Unfrozen&#xD;  28  Id: 109c.17f4 Suspend: 0 Teb: 7ff32000 Unfrozen&#xD;  29  Id: 109c.d50 Suspend: 0 Teb: 7ff31000 Unfrozen&#xD;  30  Id: 109c.820 Suspend: 0 Teb: 7ff43000 Unfrozen&#xD;  31  Id: 109c.13dc Suspend: 0 Teb: 7ff2d000 Unfrozen&#xD;  32  Id: 109c.11fc Suspend: 0 Teb: 7ff2c000 Unfrozen&#xD;  33  Id: 109c.48c Suspend: 0 Teb: 7ff2a000 Unfrozen&#xD;  34  Id: 109c.4c4 Suspend: 0 Teb: 7ff29000 Unfrozen&#xD;  35  Id: 109c.264 Suspend: 0 Teb: 7ff28000 Unfrozen&#xD;. 36  Id: 109c.c30 Suspend: 0 Teb: 7ff44000 Unfrozen&#xD;  37  Id: 109c.124c Suspend: 0 Teb: 7ff27000 Unfrozen&#xD;  38  Id: 109c.938 Suspend: 0 Teb: 7ff49000 Unfrozen&#xD;  39  Id: 109c.1228 Suspend: 0 Teb: 7ffd7000 Unfrozen&#xD;  40  Id: 109c.fac Suspend: 0 Teb: 7ff36000 Unfrozen&#xD;  41  Id: 109c.20e0 Suspend: 0 Teb: 7ffde000 Unfrozen&#xD;  42  Id: 109c.1090 Suspend: 0 Teb: 7ff30000 Unfrozen&#xD;  43  Id: 109c.25bc Suspend: 0 Teb: 7ff1f000 Unfrozen&#xD;  44  Id: 109c.26b4 Suspend: 0 Teb: 7ff37000 Unfrozen&#xD;  45  Id: 109c.6c4 Suspend: 0 Teb: 7ff26000 Unfrozen&#xD;  46  Id: 109c.1a6c Suspend: 0 Teb: 7ffdc000 Unfrozen&#xD;  47  Id: 109c.b2c Suspend: 0 Teb: 7ff2e000 Unfrozen&#xD;  48  Id: 109c.1da8 Suspend: 0 Teb: 7ff45000 Unfrozen&#xD;&#xD;This command has few interesting parameters, such as ~~[PID] that gives information from a specific thread.&#xD;&#xD;kP [number]&#xD;This command collects the stack of the current from the last instruction to the [number]th instruction. If [number] is 10, the command will listed only the last 10 instructions. What is really interesting with this command is that it may be able to retrieve the list of parameters and its contents in addition to the common k command (which retrieves the stack, function address and the source line info when available).&#xD;&#xD;This command can also be combined with thread commands to evaluate stack of all thread form instance: ~*kP 100.&#xD;&#xD;.ecxr&#xD;This command directs the debugger to the exception context, i.e. to the thread and instruction that caused the exception, when this is the case. It reports the registers states, the function address and the assembly instruction that caused the exception. After executing this command, the kP command retrieves the exactly stack of the the failed thread.&#xD;Most of the cases, the !analyze -v command, points to the correct exception context. However, during the debugging process, this context can be far way and this command set it back. Additionally, there are few times the !analyze -v command does not end the exception context. So applying this command will help much.&#xD;&#xD;d[opt] &lt;address&gt; command set&#xD;The d commands are a set of commands that retrieve the state of the memory address. Each existent [opt] of d command set display a memory range in different mode:&#xD;da - ASCII form                                        du - Unicode form&#xD;&#xD;db - byte and ASCII form:&#xD;0:000&gt; db 0x0984ad38&#xD;0984ad38  50 65 72 20 66 61 72 65-20 75 6e 61 20 73 65 67  Per fare una seg&#xD;0984ad48  6e 61 6c 61 7a 69 6f 6e-65 20 6f 20 70 6f 72 72  nalazione o porr&#xD;0984ad58  65 20 75 6e 61 20 64 6f-6d 61 6e 64 61 2c 20 63  e una domanda, c&#xD;0984ad68  6f 6e 74 61 74 74 61 72-65 20 75 6e 61 20 64 65  ontattare una de&#xD;0984ad78  6c 6c 65 0d 0a 73 65 67-75 65 6e 74 69 20 72 69  lle..seguenti ri&#xD;0984ad88  73 6f 72 73 65 20 61 7a-69 65 6e 64 61 6c 69 3a  sorse aziendali:&#xD;0984ad98  0d 0a 2e 2e 20 49 6c 20-74 75 6f 20 73 75 70 65  .... Il tuo supe&#xD;0984ada8  72 76 69 73 6f 72 65 20-6f 20 75 6e 20 61 6c 74  rvisore o un alt&#xD;&#xD;dw - 2-byte word                                       dW - 2-bytes word and ASCII&#xD;dd - 4-byte double word                            dc - 4-byte double word and ASCII&#xD;dq - 8-byte quad word&#xD;&#xD;dyb - binary and byte form:&#xD;0:000&gt; dyb 0x0984ad38&#xD;          76543210 76543210 76543210 76543210&#xD;          -------- -------- -------- --------&#xD;0984ad38  01010000 01100101 01110010 00100000  50 65 72 20&#xD;0984ad3c  01100110 01100001 01110010 01100101  66 61 72 65&#xD;0984ad40  00100000 01110101 01101110 01100001  20 75 6e 61&#xD;0984ad44  00100000 01110011 01100101 01100111  20 73 65 67&#xD;0984ad48  01101110 01100001 01101100 01100001  6e 61 6c 61&#xD;0984ad4c  01111010 01101001 01101111 01101110  7a 69 6f 6e&#xD;0984ad50  01100101 00100000 01101111 00100000  65 20 6f 20&#xD;0984ad54  01110000 01101111 01110010 01110010  70 6f 72 72&#xD;&#xD;dyd - binary and 4-byte double word&#xD;&#xD;It is possible to continue looking at the memory block by typing the same command. For instance, after typing db 0x0984ad38, the db without address will show the next block from 0984ada8+0x10:&#xD;0984adb8  72 6f 20 6d 65 6d 62 72-6f 20 64 65 6c 6c 61 20  ro membro della &#xD;0984adc8  64 69 72 69 67 65 6e 7a-61 20 61 7a 69 65 6e 64  dirigenza aziend&#xD;0984add8  61 6c 65 0d 0a 2e 2e 20-55 6e 20 72 61 70 70 72  ale.... Un rappr&#xD;0984ade8  65 73 65 6e 74 61 6e 74-65 20 64 65 6c 6c 65 20  esentante delle &#xD;0984adf8  72 69 73 6f 72 73 65 20-75 6d 61 6e 65 0d 0a 2e  risorse umane...&#xD;0984ae08  2e 20 55 6e 20 43 68 69-65 66 20 43 6f 6d 70 6c  . Un Chief Compl&#xD;0984ae18  69 61 6e 63 65 20 4f 66-66 69 63 65 72 20 28 72  iance Officer (r&#xD;0984ae28  65 73 70 6f 6e 73 61 62-69 6c 65 20 70 65 72 20  esponsabile per &#xD;&#xD;This is possible for all d command set.&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&lt;i&gt;Interesting Sequence&lt;/i&gt;&#xD;&#xD;After having shown some commands and options, how would they be used together? The answer depends on which sort of error. In any case, however, there is an interesting sequence that can be used to after the !analyze -v command. The sequence is:&#xD;.ecxr                            go to the exception context - may not be needed&#xD;kP 100                         last 100 calls on the stack&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&lt;i&gt;Conclusion&lt;/i&gt;&#xD;&#xD;Beside the commands and options shown above, the Internet has a vast number of useful sites and blogs that provider further information, tips and tricks, such as:&#xD;&#xD;ntdebugging - Advanced Windows Debugging and Troubleshooting from MSDN:&#xD;&lt;a href="http://blogs.msdn.com/b/ntdebugging/"&gt;http://blogs.msdn.com/b/ntdebugging/&lt;/a&gt;&#xD;&#xD;Crash Dump Analysis:&#xD;&lt;a href="http://www.dumpanalysis.org/blog/"&gt;http://www.dumpanalysis.org/blog/&lt;/a&gt;&#xD;&#xD;Both sites about has much more information than simply a list of commands. They also show how to use them, inform details about the error, etc.&#xD;&#xD;Common WinDbg Commands (Thematically Grouped)&#xD;&lt;a href="http://windbg.info/doc/1-common-cmds.html"&gt;http://windbg.info/doc/1-common-cmds.html&lt;/a&gt;&#xD;&#xD;This one is basically the same information found in the WinDbg help, but in one single page. Additionally, this site has a &lt;a href="http://windbg.info/forum/10-windbg-related-discussions.html"&gt;forum&lt;/a&gt; about related to WinDbg, but it may not be so useful as expected.</richText>
  </textBox>
</content>
